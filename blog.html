<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/headerStyle.css">
    <link rel="stylesheet" href="assets/html.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>ComiCommerce | Blog Detalle</title>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <header>
        <nav>
            <div class="headerContainer">
                <div style="width: 50%; text-align: left;">
                    <h4>ComiCommerce</h4>
                </div>
                <div id="cartButton" style="width: 50%; text-align: right;">
                    <a href="shoppingCart.html" class="button" style="padding: 10px 15px;">Carrito</a>
                </div>
            </div>
            <div class="headerContainer" style="background-color: rgb(255, 67, 67); justify-content: center; margin: 5px;">
                <div id="headerButtons">
                    <a href="index.html">Home</a>
                    <p>___</p>
                    <a href="catalog.html">Productos</a>
                    <p>___</p>
                    <a href="aboutUs.html">Nosotros</a>
                    <p>___</p>
                    <a href="blogs.html">Blogs</a>
                    <p>___</p>
                    <a href="contact.html">Contacto</a>
                </div>
            </div>
        </nav>
    </header>
    <main class="container mt-4 mb-4">
        <div id="blogDetailContainer" class="mb-5"></div>
        <div id="commentsSection" class="mb-5"></div>
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Deja tu comentario</h5>
                <form id="commentForm">
                    <div class="mb-3">
                        <label for="commentName" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="commentName" required>
                    </div>
                    <div class="mb-3">
                        <label for="commentText" class="form-label">Comentario</label>
                        <textarea class="form-control" id="commentText" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Enviar comentario</button>
                </form>
            </div>
        </div>
    </main>
    <footer class="mt-5">
        <nav>
            <div class="headerContainer" style="background-color: rgb(255, 67, 67); justify-content: center; margin: 5px;">
                <div id="footerButtons">
                    <a href="index.html">Home</a>
                    <a href="catalog.html">Productos</a>
                    <a href="aboutUs.html">Nosotros</a>
                    <a href="blogs.html">Blogs</a>
                    <a href="contact.html">Contacto</a>
                </div>
            </div>
            <div class="text-center py-3">&copy; 2025 ComiCommerce</div>
        </nav>
    </footer>
    <script src="scripts/countProducts.js"></script>
    <script>
    const params = new URLSearchParams(window.location.search);
    const blogId = params.get('id');

    function getBlogs() {
        return JSON.parse(localStorage.getItem('blogs')) || [];
    }

    function renderBlogDetail() {
        const blogs = getBlogs();
        const blog = blogs.find(b => b.id == blogId);
        const container = document.getElementById('blogDetailContainer');
        if (!blog) {
            container.innerHTML = '<div class="alert alert-danger">Blog no encontrado.</div>';
            return;
        }
        container.innerHTML = `
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title">${blog.titulo}</h2>
                    <h6 class="card-subtitle mb-2 text-muted">${blog.fecha}</h6>
                    <p class="card-text">${blog.descripcion}</p>
                    <p class="card-text">${blog.contenido}</p>
                </div>
            </div>
        `;
    }

    function getComments() {
        return JSON.parse(localStorage.getItem('comments_' + blogId)) || [];
    }
    function saveComment(comment) {
        const comments = getComments();
        comments.push(comment);
        localStorage.setItem('comments_' + blogId, JSON.stringify(comments));
    }
    function renderComments() {
        const comments = getComments();
        const section = document.getElementById('commentsSection');
        let html = '<h4>Comentarios</h4>';
        if (comments.length === 0) {
            html += '<p>No hay comentarios a√∫n.</p>';
        } else {
            html += '<ul class="list-group">';
            comments.forEach(c => {
                html += `<li class="list-group-item"><strong>${c.nombre}:</strong> ${c.texto}</li>`;
            });
            html += '</ul>';
        }
        section.innerHTML = html;
    }
    document.getElementById('commentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const nombre = document.getElementById('commentName').value.trim();
        const texto = document.getElementById('commentText').value.trim();
        if (nombre && texto) {
            saveComment({ nombre, texto });
            renderComments();
            this.reset();
        }
    });
    renderBlogDetail();
    renderComments();
    </script>
</body>
</html>
